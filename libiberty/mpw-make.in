#
# Makefile
#   Copyright (C) 1990, 1991, 1992 Free Software Foundation
#
# This file is part of the libiberty library.
# Libiberty is free software; you can redistribute it and/or
# modify it under the terms of the GNU Library General Public
# License as published by the Free Software Foundation; either
# version 2 of the License, or (at your option) any later version.
#
# Libiberty is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Library General Public License for more details.
#
# You should have received a copy of the GNU Library General Public
# License along with libiberty; see the file COPYING.LIB.  If
# not, write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330,
# Boston, MA 02111-1307, USA.
#

# This file was written, and is maintained by K. Richard Pixley
# <rich@cygnus.com>.

#
# Makefile for libiberty directory
#

s = "{srcdir}"

o = :

INCDIR = {topsrcdir}include
CSEARCH =  -i {INCDIR},{INCDIR}:,{INCDIR}:mpw:,::extra-include:,{srcdir}

ALL_CFLAGS = {CFLAGS} -d NEED_sys_siglist -d NEED_sys_errlist -d NEED_basename {CSEARCH}

"{o}" \Option-f : "{s}"

# Default rule that puts each file into separate segment.

.c.o  \Option-f .c
   {CC}  {DepDir}{Default}.c {ALL_CFLAGS} {SymOptions} -s {Default} -o {TargDir}{Default}.c.o

prefix = :usr:local

exec_prefix = {prefix}
bindir = {exec_prefix}:bin
libdir = {exec_prefix}:lib

datadir = {prefix}:lib

mandir = {prefix}:man
man1dir = {mandir}:man1
man2dir = {mandir}:man2
man3dir = {mandir}:man3
man4dir = {mandir}:man4
man5dir = {mandir}:man5
man6dir = {mandir}:man6
man7dir = {mandir}:man7
man8dir = {mandir}:man8
man9dir = {mandir}:man9
infodir = {prefix}:info
includedir = {prefix}:include
oldincludedir =
docdir = {datadir}:doc

SHELL = :bin:sh

INSTALL = install -c
INSTALL_PROGRAM = {INSTALL}
INSTALL_DATA = {INSTALL}

AR = ar
AR_FLAGS = rc

#CFLAGS = -g
BISON = bison
MAKEINFO = makeinfo
RANLIB = ranlib

MAKEOVERRIDES =

XTRAFLAGS =

TARGETLIB = libiberty.o

CONFIG_H = lconfig.h
NEEDED_LIST = lneeded-list

# HOST_OFILES contains the list of objects that should be in the
# library (in addition to the REQUIRED_OFILES and EXTRA_OFILES}.
# A configuration may override this with a fixed list a object files
# names (hard to maintain}, or some other way to generate a list.
# HOST_OFILES=`cat needed-list`
HOST_OFILES = "{o}"alloca.c.o "{o}"mpw.c.o "{o}"strdup.c.o \Option-d
  "{o}"insque.c.o "{o}"bcopy.c.o

# Extra targets that the top-level target depends on.
# Specifically, what needs to be made before HOST_OFILES can be used.
# Can be empty if HOST_OFILES is just a list of file names.
DO_ALSO = needed-list

# A configuration can specify extra .o files that should be included,
# even if they are in libc. (Perhaps the libc version is buggy.}
EXTRA_OFILES = 

all \Option-f {TARGETLIB}

#### Host, target, and site specific Makefile fragments come in here.
###


# NOTE \Option-f If you add new files to the library, add them to this list
# (alphabetical}, and add them to REQUIRED_OFILES or 'functions.def'.
CFILES = alloca.c argv.c basename.c bcmp.c bcopy.c bzero.c concat.c \Option-d
	 cplus-dem.c fdmatch.c getcwd.c getopt.c getopt1.c getpagesize.c getruntime.c \Option-d
         floatformat.c hex.c index.c insque.c \Option-d
	 memchr.c memcmp.c memcpy.c memmove.c memset.c \Option-d
         obstack.c random.c rename.c rindex.c sigsetmask.c spaces.c \Option-d
	 strcasecmp.c strncasecmp.c \Option-d
         strchr.c strdup.c strerror.c strrchr.c strsignal.c \Option-d
         strstr.c strtod.c strtol.c strtoul.c tmpnam.c \Option-d
	 vasprintf.c vfork.c vfprintf.c vprintf.c vsprintf.c waitpid.c \Option-d
	 xatexit.c xexit.c xmalloc.c
# These are always included in the library.
REQUIRED_OFILES = "{o}"argv.c.o "{o}"basename.c.o "{o}"concat.c.o "{o}"cplus-dem.c.o \Option-d
  "{o}"getopt.c.o "{o}"getopt1.c.o "{o}"getruntime.c.o "{o}"hex.c.o "{o}"floatformat.c.o "{o}"obstack.c.o "{o}"spaces.c.o "{o}"strcasecmp.c.o "{o}"strerror.c.o "{o}"strncasecmp.c.o "{o}"strsignal.c.o \Option-d
  "{o}"vasprintf.c.o "{o}"xatexit.c.o "{o}"xexit.c.o "{o}"xmalloc.c.o 

AVOID =  "{o}"fdmatch.c.o

# Do we want/need any config overrides?
#	 

STAGESTUFF = {TARGETLIB} *.c.o

INSTALL_DEST = libdir
install \Option-f install_to_{INSTALL_DEST}

{TARGETLIB} \Option-f {REQUIRED_OFILES} {HOST_OFILES}
	Lib -o {TARGETLIB} {REQUIRED_OFILES} {HOST_OFILES}

